/**
* @license
* Copyright 2022 OneLoop.js
* Author: Nicolas Langle
* Repository: https://github.com/n-langle/OneLoop.js
* Version: 5.0.0
* SPDX-License-Identifier: MIT
* 
* Credit for easing functions goes to : https://github.com/ai/easings.net/blob/master/src/easings/easingsFunctions.ts
* Credit for Emoji regexp goes to : https://medium.com/reactnative/emojis-in-javascript-f693d0eb79fb
*/
const u=window,t=document.documentElement,s=Math,q=s.pow,d=s.sqrt,c=s.sin,p=s.cos,_=s.PI,Q=s.max,V=s.min,i=s.abs,z=s.round;var B=function(){const e=q,s=d,i=c,r=p,n=_,h=1.70158,u=1.525*h,a=(h,2*n/3),l=2*n/4.5;function o(t){var e=7.5625,s=2.75;return t<1/s?e*t*t:t<2/s?e*(t-=1.5/s)*t+.75:t<2.5/s?e*(t-=2.25/s)*t+.9375:e*(t-=2.625/s)*t+.984375}return{linear(t){return t},easeInQuad(t){return t*t},easeOutQuad(t){return 1-(1-t)*(1-t)},easeInOutQuad(t){return t<.5?2*t*t:1-e(-2*t+2,2)/2},easeInCubic(t){return t*t*t},easeOutCubic(t){return 1-e(1-t,3)},easeInOutCubic(t){return t<.5?4*t*t*t:1-e(-2*t+2,3)/2},easeInQuart(t){return t*t*t*t},easeOutQuart(t){return 1-e(1-t,4)},easeInOutQuart(t){return t<.5?8*t*t*t*t:1-e(-2*t+2,4)/2},easeInQuint(t){return t*t*t*t*t},easeOutQuint(t){return 1-e(1-t,5)},easeInOutQuint(t){return t<.5?16*t*t*t*t*t:1-e(-2*t+2,5)/2},easeInSine(t){return 1-r(t*n/2)},easeOutSine(t){return i(t*n/2)},easeInOutSine(t){return-(r(n*t)-1)/2},easeInExpo(t){return 0===t?0:e(2,10*t-10)},easeOutExpo(t){return 1===t?1:1-e(2,-10*t)},easeInOutExpo(t){return 0===t?0:1===t?1:t<.5?e(2,20*t-10)/2:(2-e(2,-20*t+10))/2},easeInCirc(t){return 1-s(1-e(t,2))},easeOutCirc(t){return s(1-e(t-1,2))},easeInOutCirc(t){return t<.5?(1-s(1-e(2*t,2)))/2:(s(1-e(-2*t+2,2))+1)/2},easeInBack(t){return 2.70158*t*t*t-h*t*t},easeOutBack(t){return 1+2.70158*e(t-1,3)+h*e(t-1,2)},easeInOutBack(t){return t<.5?e(2*t,2)*(7.189819*t-u)/2:(e(2*t-2,2)*((1+u)*(2*t-2)+u)+2)/2},easeInElastic(t){return 0===t?0:1===t?1:-e(2,10*t-10)*i((10*t-10.75)*a)},easeOutElastic(t){return 0===t?0:1===t?1:e(2,-10*t)*i((10*t-.75)*a)+1},easeInOutElastic(t){return 0===t?0:1===t?1:t<.5?-(e(2,20*t-10)*i((20*t-11.125)*l))/2:e(2,-20*t+10)*i((20*t-11.125)*l)/2+1},easeInBounce(t){return 1-o(1-t)},easeOutBounce:o,easeInOutBounce(t){return t<.5?(1-o(1-2*t))/2:(1+o(2*t-1))/2}}}(),r=()=>performance.now();const n=[];let h=null,a=null;function D(e){var s=(e-a)/16.66;for(let t=0;t<n.length;t++)n[t].needsUpdate(e)?n[t].update(e,s):(n.splice(t,1)[0].complete(e,s),t--);h=n.length?(a=e,requestAnimationFrame(D)):null}var l={add(t){return-1===n.indexOf(t)&&(n.push(t),null===h&&this.start()),this},remove(t){t=n.indexOf(t);return-1<t&&n.splice(t,1),this},start(){return null===h&&(a=r(),h=requestAnimationFrame(D)),this},stop(){return cancelAnimationFrame(h),h=null,this},destroy(){n.length=0,this.stop()}};function o(){const e=arguments,s=e[0];for(let t=1;t<e.length;t++)for(var i in e[t])void 0!==e[t][i]&&(s[i]=e[t][i]);return s}var f=()=>{};class y{constructor(t){o(this,y.defaults,t)}start(){return l.add(this),this.onStart.call(this,r(),0),this}stop(){return l.remove(this),this.onStop.call(this,r(),0),this}update(t,e){return this.onUpdate.call(this,t,e),this}complete(t,e){return this.onComplete.call(this,t,e),this}needsUpdate(){return!0}static defaults={onStart:f,onUpdate:f,onStop:f,onComplete:f}}class F extends y{constructor(t){super(o({},F.defaults,t)),this._a=0,this._b=1,this._c=0,this._d=this.reverse?1:0,this._e=0,this._f=null,this.autoStart&&this.start()}reset(){return this._f=null,this._b=1,this._c=0,this._d=this.reverse?1:0,l.remove(this),this.onUpdate(0,0,0),this}pause(){return this._f=r(),l.remove(this),this}start(t){return 0===(t=0===t||t?t:this.delay)?(this._f?(this._e+=r()-this._f,this._f=null):(this.reverse&&(this._b=j[this._d](this._c),this._d=(this._d+1)%2),this._e=0,this._a=r(),this.onStart(this._a,0,1-this._b)),l.add(this)):setTimeout(this.start.bind(this,0),t),this}update(t,e){var s=B[this.easing]((t-(this._a+this._e))/(this.duration*this._b))*this._b+1-this._b,s=j[this._d](s);return this._c=s,this.onUpdate(t,e,s),this}complete(t,e){var s=(this._d+1)%2;return this._f=null,this.onUpdate(t,e,s),this.onComplete(t,e,s),0<this.loop&&(this.loop--,this.start()),this}needsUpdate(t){return t-(this._a+this._e)<this.duration*this._b}static defaults={delay:0,duration:1e3,easing:"linear",loop:0,reverse:!1,autoStart:!0}}const j=[t=>t,t=>1-t];var v=(t,e)=>"string"==typeof t?(e||document).querySelectorAll(t):0<=t.length?t:[t];const b=[];class x extends y{constructor(t,s,i){super();const r={};r[s+"start"]=[],r[s]=[],r[s+"end"]=[],this._g=r,this._h=!1,this._i=null,this._j=t,this._k=s,this._l=null,this._m=i||"",this._n=()=>{this._h=!1},this._o=()=>{this._l=e,this._h||(this._h=!0,this.start(),g(this._g[this._k+"start"],e)),clearTimeout(this._i),this._i=setTimeout(this._n,128)},this._j.addEventListener(this._k,this._o,{passive:!0})}destroy(){var t=b.indexOf(this);-1<t&&b.splice(t,1),this._j.removeEventListener(this._k,this._o)}add(t,e){return-1===this._g[t].indexOf(e)&&this._g[t].push(e),this}remove(t,e){e=this._g[t].indexOf(e);return-1<e&&this._g[t].splice(e,1),this}hasEvent(){var t=this._g,e=this._k;return 0<t[e+"start"].length+t[e].length+t[e+"end"].length}update(t,e){return g(this._g[this._k],this._l),super.update(t,e),this}complete(t,e){return g(this._g[this._k+"end"],this._l),super.complete(t,e),this}needsUpdate(){return this._h}static getInstance(e,s,i){let r;i=i||"";for(let t=0;t<b.length;t++){var n=b[t];if(n._k===s&&n._j===e&&n._m===i){r=b[t];break}}return r||(r=new x(e,s,i),b.push(r)),r}static destroy(){for(;b[0];)b[0].destroy()}}function g(e,s){for(let t=0;t<e.length;t++)e[t](s)}class m{constructor(t,e){this.x=t||0,this.y="number"==typeof e?e:this.x}set(t,e){return this.x=t,this.y=e,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}subtractScalar(t){return this.x-=t,this.y-=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.x/=t,this.y/=t,this}magnitude(){return d(this.x*this.x+this.y*this.y)}normalize(){return this.divideScalar(this.magnitude())}reverse(){return this.multiplyScalar(-1)}copy(t){return this.x=t.x,this.y=t.y,this}clone(){return new m(this.x,this.y)}angle(){var t=s.atan2(this.y,this.x);return t<0&&(t+=2*_),t}rotate(t){var e=this.x;return this.x=e*p(t)-this.y*c(t),this.y=e*c(t)+this.y*p(t),this}}var T=()=>new m(t.scrollWidth,t.scrollHeight),O=()=>new m(u.pageXOffset,u.pageYOffset);class N{constructor(t,e,s){o(this,N.defaults,e),this.element=t,this._p=!1,this.children=this.children?v(this.children,this.element):[],this.refresh(s)}refresh(t){var e=this.element.getBoundingClientRect(),s=u.innerHeight,i=u.innerWidth,r=O(),n=r.x,r=r.y,h=T();return this.distanceRTW=new m(i+e.right-e.left,s+e.bottom-e.top),this.startRTW=new m(e.right-this.distanceRTW.x+n,e.bottom-this.distanceRTW.y+r),this.startRTE=new m(Q(e.left+n-i,0),Q(e.top+r-s,0)),this.distanceRTE=new m(V(e.right+n-this.startRTE.x,h.x-i),V(e.bottom+r-this.startRTE.y,h.y-s)),this.control(t),this}control(t){const e=t.scroll,s=e.clone().subtract(this.startRTW).divide(this.distanceRTW),i=e.clone().subtract(this.startRTE).divide(this.distanceRTE);return 0<=s.x&&s.x<=1&&0<=s.y&&s.y<=1?(this._p||(this._p=!0,this.onVisibilityStart.call(this,t,w(s),w(i)),this.onVisible.call(this,t,w(s),w(i))),this.onVisible.call(this,t,s,i)):this._p&&(this._p=!1,this.onVisible.call(this,t,w(s),w(i)),this.onVisibilityEnd.call(this,t,w(s),w(i))),this.onAlways.call(this,t,s,i),this}static defaults={children:"",onVisible:f,onVisibilityStart:f,onVisibilityEnd:f,onAlways:f}}function w(t){return new m(i(z(t.x)),i(z(t.y)))}const I=[];let S=null,R=null,E=null;class L extends y{constructor(t){super(o({},L.defaults,t)),this._q=[],this._r=[],this._s=()=>this.start(),this._t=()=>this.refresh(),this._u=new m(0,0),this._h=!0,this._v=T(),R=R||new x(u,"resize"),E=E||new x(u,"scroll"),R.add("resize",this._t),E.add("scrollstart",this._s),I.push(this),L.startAutoRefresh()}destroy(){this._h&&(this._h=!1,I.splice(I.indexOf(this),1),0===I.length?(L.stopAutoRefresh(),R.destroy(),E.destroy(),R=E=null):(R.remove("resize",this._t),E.remove("scrollstart",this._s)))}observe(t,e){var s=v(t),i=this.getScrollInfos();for(let t=0;t<s.length;t++)-1===this._q.indexOf(s[t])&&(this._r.push(new N(s[t],e,i)),this._q.push(s[t]));return this}unobserve(t){var e=v(t);for(let t=0;t<e.length;t++){var s=this._q.indexOf(e[t]);-1<s&&(this._q.splice(s,1),this._r.splice(s,1))}return this}update(t,e){super.update(t,e);var s=this.getScrollInfos();for(let t=0;t<this._r.length;t++)this._r[t].control(s);return this._u.copy(s.scroll),this}needsUpdate(){return this._h&&E.needsUpdate()||1<this.scrollDivider&&1<O().subtract(this._u).magnitude()}hasEntry(){return 0<this._r.length}getScrollInfos(){const t=this._u,e=O().subtract(t).divideScalar(this.scrollDivider).add(t),s=e.clone().subtract(t);return{scroll:e,delta:s,direction:new m(s.x/i(s.x)||0,s.y/i(s.y)||0)}}refresh(){var e=this.getScrollInfos();for(let t=0;t<this._r.length;t++)this._r[t].refresh(e);return this.onRefresh.call(this,e),this}static defaults={scrollDivider:1,onRefresh:f};static autoRefreshDelay=1e3;static startAutoRefresh(){let e=T();return null===S&&null!==L.autoRefreshDelay&&(S=setInterval(()=>{var t=T();if(e.x!==t.x||e.y!==t.y){for(let t=0;t<I.length;t++)I[t].refresh();e=t}},L.autoRefreshDelay)),this}static stopAutoRefresh(){return clearInterval(S),S=null,this}static destroy(){for(;I[0];)I[0].destroy()}}const W=[],P=/(((?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])((\u200D(\u2640|\u2642)\uFE0F)|[]))|&([a-zA-Z]{2,6}|#[0-9]{2,5});|<|>)/g,X=/(\s)/;let H=null;class M{constructor(t,e){o(this,M.defaults,e),this._w=t.innerHTML,this._x=t,this._t=this.split.bind(this),H=H||new x(u,"resize"),this.autoSplit&&this.split(),W.push(this)}destroy(){this.restore(),W.splice(W.indexOf(this),1),W.length||(H.destroy(),H=null)}restore(){return this._x.innerHTML=this._w,H.remove("resize",this._t),this}split(){const t=this._x;if(t.innerHTML=this._w,this.byLine){Y(t,k("st-word-temp"));var r=t.children,n=(t,e)=>t?this.lineWrapper(t)+e:"";let e="",s="",i=r[0].offsetTop;H.add("resize",this._t);for(let t=0;t<r.length;t++){var h=r[t],u=h.offsetTop,a="BR"===h.tagName;i===u&&!a||(s+=n(e.substring(-1)," "),e=""),a?s+="<br />":e+=h.outerHTML+" ",i=u}t.innerHTML=s+n(e,""),t.innerHTML=function e(t,s){return C(t,t=>t,t=>t.classList.contains(s)?t.innerHTML:U(t,e(t,s)))}(t,"st-word-temp")}return this.byWord&&Y(t,this.wordWrapper),this.byChar&&(t.innerHTML=function e(t,s){return C(t,t=>t.replace(P,s),t=>U(t,e(t,s)))}(t,this.charWrapper),t.innerHTML=A(t,"",t=>X.test(t)?t:this.charWrapper(t),this.preserve)),this}static defaults={autoSplit:!0,byLine:!1,byWord:!1,byChar:!1,preserve:"st-char",lineWrapper:k("st-line"),wordWrapper:k("st-word"),charWrapper:k("st-char")}}function k(e){return t=>'<span class="'+e+'">'+t+"</span>"}function C(t,e,s){var i=t.childNodes;let r="";for(let t=0;t<i.length;t++){var n=i[t];3===n.nodeType?r+=e(n.data):1===n.nodeType&&(r+=s(n))}return r}function A(t,s,i,e){return C(t,t=>{const e=t.trim();return""!==e?(""===s?t:e).split(s).map(i).join(s):t},t=>e&&t.classList.contains(e)?t.outerHTML:U(t,A(t,s,i,e)))}function U(t,e){return t.outerHTML.replace(">"+t.innerHTML+"<",">"+e+"<")}function Y(t,e){t.innerHTML=function e(t){return C(t,t=>t.replace("<","[<]"),t=>U(t,e(t)))}(t),t.innerHTML=A(t," ",e).replace("[<]","&lt;")}M.destroy=function(){for(;W[0];)W[0].destroy()};export{y as MainLoopEntry,L as ScrollObserver,M as SplittedText,x as ThrottledEvent,F as Tween,m as Vector2,B as easings};
