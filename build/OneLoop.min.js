/**
* @license
* Copyright 2022 OneLoop.js
* Author: Nicolas Langle
* Repository: https://github.com/n-langle/OneLoop.js
* Version: 5.0.3
* SPDX-License-Identifier: MIT
* 
* Credit for easing functions goes to : https://github.com/ai/easings.net/blob/master/src/easings/easingsFunctions.ts
* Credit for Emoji regexp goes to : https://medium.com/reactnative/emojis-in-javascript-f693d0eb79fb
*/
const d=window,U=document.documentElement,s=Math,a=s.pow,u=s.sqrt,l=s.sin,o=s.cos,c=s.PI,_=s.max,p=s.min,q=s.abs,Q=s.round;var V=function(){const s=1.70158,e=1.525*s,i=1+s,r=2*c/3,h=2*c/4.5,n=t=>{var s=7.5625,e=2.75;return t<1/e?s*t*t:t<2/e?s*(t-=1.5/e)*t+.75:t<2.5/e?s*(t-=2.25/e)*t+.9375:s*(t-=2.625/e)*t+.984375};return{linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuadx:t=>t<.5?2*t*t:1-a(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-a(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-a(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-a(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-a(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-a(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-a(-2*t+2,5)/2,easeInSine:t=>1-o(t*c/2),easeOutSine:t=>l(t*c/2),easeInOutSine:t=>-(o(c*t)-1)/2,easeInExpo:t=>0===t?0:a(2,10*t-10),easeOutExpo:t=>1===t?1:1-a(2,-10*t),easeInOutExpo:t=>0===t?0:1===t?1:t<.5?a(2,20*t-10)/2:(2-a(2,-20*t+10))/2,easeInCirc:t=>1-u(1-a(t,2)),easeOutCirc:t=>u(1-a(t-1,2)),easeInOutCirc:t=>t<.5?(1-u(1-a(2*t,2)))/2:(u(1-a(-2*t+2,2))+1)/2,easeInBack:t=>i*t*t*t-s*t*t,easeOutBack:t=>1+i*a(t-1,3)+s*a(t-1,2),easeInOutBack:t=>t<.5?a(2*t,2)*(2*(1+e)*t-e)/2:(a(2*t-2,2)*((1+e)*(2*t-2)+e)+2)/2,easeInElastic:t=>0===t?0:1===t?1:-a(2,10*t-10)*l((10*t-10.75)*r),easeOutElastic:t=>0===t?0:1===t?1:a(2,-10*t)*l((10*t-.75)*r)+1,easeInOutElastic:t=>0===t?0:1===t?1:t<.5?-(a(2,20*t-10)*l((20*t-11.125)*h))/2:a(2,-20*t+10)*l((20*t-11.125)*h)/2+1,easeInBounce:t=>1-n(1-t),easeOutBounce:n,easeInOutBounce:t=>t<.5?(1-n(1-2*t))/2:(1+n(2*t-1))/2}}(),e=()=>performance.now();const i=[];let r=null,t=null;function z(s){var e=(s-t)/16.66;for(let t=0;t<i.length;t++)i[t].needsUpdate(s)?i[t].update(s,e):(i.splice(t,1)[0].complete(s,e),t--);r=i.length?(t=s,requestAnimationFrame(z)):null}var h={add(t){return-1===i.indexOf(t)&&(i.push(t),null===r)&&this.start(),this},remove(t){t=i.indexOf(t);return-1<t&&i.splice(t,1),this},start(){return null===r&&(t=e(),r=requestAnimationFrame(z)),this},stop(){return cancelAnimationFrame(r),r=null,this},destroy(){i.length=0,this.stop()}};function n(){var s=arguments,e=s[0];for(let t=1;t<s.length;t++)for(var i in s[t])void 0!==s[t][i]&&(e[i]=s[t][i]);return e}var f=()=>{};class y{constructor(t){n(this,y.defaults,t)}start(){return h.add(this),this.onStart.call(this,e(),0),this}stop(){return h.remove(this),this.onStop.call(this,e(),0),this}update(t,s){return this.onUpdate.call(this,t,s),this}complete(t,s){return this.onComplete.call(this,t,s),this}needsUpdate(){return!0}static defaults={onStart:f,onUpdate:f,onStop:f,onComplete:f}}class B extends y{constructor(t){super(n({},B.defaults,t)),this._a=0,this._b=1,this._c=0,this._d=this.reverse?1:0,this._e=0,this._f=null,this.autoStart&&this.start()}reset(){return this._f=null,this._b=1,this._c=0,this._d=this.reverse?1:0,h.remove(this),this.onUpdate(0,0,0),this}pause(){return this._f=e(),h.remove(this),this}start(t){return 0===(t=0!==t?t||this.delay:t)?(this._f?(this._e+=e()-this._f,this._f=null):(this.reverse&&(this._b=D[this._d](this._c),this._d=(this._d+1)%2),this._e=0,this._a=e(),this.onStart(this._a,0,1-this._b)),h.add(this)):setTimeout(this.start.bind(this,0),t),this}update(t,s){var e=V[this.easing]((t-(this._a+this._e))/(this.duration*this._b))*this._b+1-this._b,e=D[this._d](e);return this._c=e,this.onUpdate(t,s,e),this}complete(t,s){var e=(this._d+1)%2;return this._f=null,this.onUpdate(t,s,e),this.onComplete(t,s,e),0<this.loop&&(this.loop--,this.start()),this}needsUpdate(t){return t-(this._a+this._e)<this.duration*this._b}static defaults={delay:0,duration:1e3,easing:"linear",loop:0,reverse:!1,autoStart:!0}}const D=[t=>t,t=>1-t];var v=(t,s)=>"string"==typeof t?(s||document).querySelectorAll(t):0<=t.length?t:[t];const b=[];class x extends y{constructor(t,s,e){super();var i={};i[s+"start"]=[],i[s]=[],i[s+"end"]=[],this._g=i,this._h=!1,this._i=null,this._j=t,this._k=s,this._l=null,this._m=e||"",this._n=()=>{this._h=!1},this._o=t=>{this._l=t,this._h||(this._h=!0,this.start(),g(this._g[this._k+"start"],t)),clearTimeout(this._i),this._i=setTimeout(this._n,128)},this._j.addEventListener(this._k,this._o,{passive:!0})}destroy(){var t=b.indexOf(this);-1<t&&b.splice(t,1),this._j.removeEventListener(this._k,this._o)}add(t,s){return-1===this._g[t].indexOf(s)&&this._g[t].push(s),this}remove(t,s){s=this._g[t].indexOf(s);return-1<s&&this._g[t].splice(s,1),this}hasEvent(){var t=this._g,s=this._k;return 0<t[s+"start"].length+t[s].length+t[s+"end"].length}update(t,s){return g(this._g[this._k],this._l),super.update(t,s),this}complete(t,s){return g(this._g[this._k+"end"],this._l),super.complete(t,s),this}needsUpdate(){return this._h}static getInstance(s,e,i){let r;i=i||"";for(let t=0;t<b.length;t++){var h=b[t];if(h._k===e&&h._j===s&&h._m===i){r=b[t];break}}return r||(r=new x(s,e,i),b.push(r)),r}static destroy(){for(;b[0];)b[0].destroy()}}function g(s,e){for(let t=0;t<s.length;t++)s[t](e)}class m{constructor(t,s){this.x=t||0,this.y="number"==typeof s?s:this.x}set(t,s){return this.x=t,this.y=s,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}subtractScalar(t){return this.x-=t,this.y-=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.x/=t,this.y/=t,this}magnitude(){return u(this.x*this.x+this.y*this.y)}normalize(){return this.divideScalar(this.magnitude())}reverse(){return this.multiplyScalar(-1)}copy(t){return this.x=t.x,this.y=t.y,this}clone(){return new m(this.x,this.y)}angle(){var t=s.atan2(this.y,this.x);return t<0&&(t+=2*c),t}rotate(t){var s=this.x;return this.x=s*o(t)-this.y*l(t),this.y=s*l(t)+this.y*o(t),this}}var T=()=>new m(U.scrollWidth,U.scrollHeight),O=()=>new m(d.pageXOffset,d.pageYOffset);class F{constructor(t,s,e){n(this,F.defaults,s),this.element=t,this._p=!0,this.children=this.children?v(this.children,this.element):[],this.refresh(e)}refresh(t){var s=this.element.getBoundingClientRect(),e=s.height,i=s.width,r=s.right,h=s.bottom,n=d.innerHeight,a=d.innerWidth,u=O(),l=u.x,u=u.y,o=T();return this.distanceRTW=new m(a+i,n+e),this.startRTW=new m(r-this.distanceRTW.x+l,h-this.distanceRTW.y+u),this.startRTE=new m(_(s.left+l-a,0),_(s.top+u-n,0)),this.distanceRTE=new m(p(r+l-this.startRTE.x,o.x-r-l+i,o.x-a),p(h+u-this.startRTE.y,o.y-h-u+e,o.y-n)),this.control(t),this}control(t){var s=t.scroll,e=s.clone().subtract(this.startRTW).divide(this.distanceRTW),s=s.clone().subtract(this.startRTE).divide(this.distanceRTE);return 0<=e.x&&e.x<=1&&0<=e.y&&e.y<=1?(this._p||(this._p=!0,this.onVisibilityStart.call(this,t,w(e),w(s)),this.onVisible.call(this,t,w(e),w(s))),this.onVisible.call(this,t,e,s)):this._p&&(this._p=!1,this.onVisible.call(this,t,w(e),w(s)),this.onVisibilityEnd.call(this,t,w(e),w(s))),this.onAlways.call(this,t,e,s),this}static defaults={children:"",onVisible:f,onVisibilityStart:f,onVisibilityEnd:f,onAlways:f}}function w(t){return new m(p(_(0,Q(t.x)),1),p(_(0,Q(t.y)),1))}const I=[];let S=null,R=null,E=null;class L extends y{constructor(t){super(n({},L.defaults,t)),this._q=[],this._r=[],this._s=()=>this.start(),this._t=()=>this.refresh(),this._u=O(),this._h=!0,this._v=T(),R=R||new x(d,"resize"),E=E||new x(d,"scroll"),R.add("resize",this._t),E.add("scrollstart",this._s),I.push(this),L.startAutoRefresh()}destroy(){this._h&&(this._h=!1,I.splice(I.indexOf(this),1),0===I.length?(L.stopAutoRefresh(),R.destroy(),E.destroy(),R=E=null):(R.remove("resize",this._t),E.remove("scrollstart",this._s)))}observe(t,s){var e=v(t),i=this.getScrollInfos();for(let t=0;t<e.length;t++)-1===this._q.indexOf(e[t])&&(this._r.push(new F(e[t],s,i)),this._q.push(e[t]));return this}unobserve(t){var s=v(t);for(let t=0;t<s.length;t++){var e=this._q.indexOf(s[t]);-1<e&&(this._q.splice(e,1),this._r.splice(e,1))}return this}update(t,s){super.update(t,s);var e=this.getScrollInfos();for(let t=0;t<this._r.length;t++)this._r[t].control(e);return this._u.copy(e.scroll),this}needsUpdate(){return this._h&&E.needsUpdate()||1<this.scrollDivider&&1<O().subtract(this._u).magnitude()}hasEntry(){return 0<this._r.length}getScrollInfos(){var t=this._u,s=O().subtract(t).divideScalar(this.scrollDivider).add(t),t=s.clone().subtract(t);return{scroll:s,delta:t,direction:new m(t.x/q(t.x)||0,t.y/q(t.y)||0)}}refresh(){var s=this.getScrollInfos();for(let t=0;t<this._r.length;t++)this._r[t].refresh(s);return this.onRefresh.call(this,s),this}static defaults={scrollDivider:1,onRefresh:f};static autoRefreshDelay=1e3;static startAutoRefresh(){let s=T();return null===S&&null!==L.autoRefreshDelay&&(S=setInterval(()=>{var t=T();if(s.x!==t.x||s.y!==t.y){for(let t=0;t<I.length;t++)I[t].refresh();s=t}},L.autoRefreshDelay)),this}static stopAutoRefresh(){return clearInterval(S),S=null,this}static destroy(){for(;I[0];)I[0].destroy()}}const W=[],j=/(((?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])((\u200D(\u2640|\u2642)\uFE0F)|[]))|&([a-zA-Z]{2,6}|#[0-9]{2,5});|<|>)/g,N=/(\s)/;let H=null;class M{constructor(t,s){n(this,M.defaults,s),this._w=t.innerHTML,this._x=t,this._t=this.split.bind(this),H=H||new x(d,"resize"),this.autoSplit&&this.split(),W.push(this)}destroy(){var t=W.indexOf(this);-1<t&&(this.restore(),W.splice(t,1),W.length||(H.destroy(),H=null))}restore(){return this._x.innerHTML=this._w,H.remove("resize",this._t),this}split(){var t=this._x,s=this._w;if(s){if(t.innerHTML!==s&&this.restore(),this.byLine){Z(t,k("st-word-temp"));var r=t.children,h=(t,s)=>t?this.lineWrapper(t)+s:"";let s="",e="",i=r[0].offsetTop;H.add("resize",this._t);for(let t=0;t<r.length;t++){var n=r[t],a=n.offsetTop,u="BR"===n.tagName;i===a&&!u||(e+=h(s.substring(-1)," "),s=""),u?e+="<br />":s+=n.outerHTML+" ",i=a}t.innerHTML=e+h(s,""),t.innerHTML=Y(t,"st-word-temp")}this.byWord&&Z(t,this.wordWrapper),this.byChar&&(t.innerHTML=P(t,this.charWrapper),t.innerHTML=X(t,"",t=>N.test(t)?t:this.charWrapper(t),this.preserve))}return this}static defaults={autoSplit:!0,byLine:!1,byWord:!1,byChar:!1,preserve:"st-char",lineWrapper:k("st-line"),wordWrapper:k("st-word"),charWrapper:k("st-char")}}function k(s){return t=>'<span class="'+s+'">'+t+"</span>"}function C(t,s,e){var i=t.childNodes;let r="";for(let t=0;t<i.length;t++){var h=i[t];3===h.nodeType?r+=s(h.data):1===h.nodeType&&(r+=e(h))}return r}function P(t,s){return C(t,t=>t.replace(j,s),t=>A(t,P(t,s)))}function X(t,e,i,s){return C(t,t=>{var s=t.trim();return""!==s?(""===e?t:s).split(e).map(i).join(e):t},t=>s&&t.classList.contains(s)?t.outerHTML:A(t,X(t,e,i,s)))}function Y(t,s){return C(t,t=>t,t=>t.classList.contains(s)?t.innerHTML:A(t,Y(t,s)))}function A(t,s){return t.outerHTML.replace(">"+t.innerHTML+"<",">"+s+"<")}function Z(t,s){t.innerHTML=function s(t){return C(t,t=>t.replace("<","[<]"),t=>A(t,s(t)))}(t),t.innerHTML=X(t," ",s).replace("[<]","&lt;")}M.destroy=function(){for(;W[0];)W[0].destroy()};export{y as MainLoopEntry,L as ScrollObserver,M as SplittedText,x as ThrottledEvent,B as Tween,m as Vector2,V as easings};
