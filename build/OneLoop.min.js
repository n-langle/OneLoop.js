/**
* @license
* Copyright 2022 OneLoop.js
* Author: Nicolas Langle
* Repository: https://github.com/n-langle/OneLoop.js
* Version: 5.0.0
* SPDX-License-Identifier: MIT
* 
* Credit for easing functions goes to : https://github.com/ai/easings.net/blob/master/src/easings/easingsFunctions.ts
* Credit for Emoji regexp goes to : https://medium.com/reactnative/emojis-in-javascript-f693d0eb79fb
*/
const u=window,U=document.documentElement,s=Math,a=s.pow,l=s.sqrt,o=s.sin,d=s.cos,c=s.PI,q=s.max,Q=s.min,i=s.abs,V=s.round;var z=function(){const s=1.70158,e=1.525*s,i=1+s,r=2*c/3,n=2*c/4.5,h=t=>{var s=7.5625,e=2.75;return t<1/e?s*t*t:t<2/e?s*(t-=1.5/e)*t+.75:t<2.5/e?s*(t-=2.25/e)*t+.9375:s*(t-=2.625/e)*t+.984375};return{linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuadx:t=>t<.5?2*t*t:1-a(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-a(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-a(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-a(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-a(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-a(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-a(-2*t+2,5)/2,easeInSine:t=>1-d(t*c/2),easeOutSine:t=>o(t*c/2),easeInOutSine:t=>-(d(c*t)-1)/2,easeInExpo:t=>0===t?0:a(2,10*t-10),easeOutExpo:t=>1===t?1:1-a(2,-10*t),easeInOutExpo:t=>0===t?0:1===t?1:t<.5?a(2,20*t-10)/2:(2-a(2,-20*t+10))/2,easeInCirc:t=>1-l(1-a(t,2)),easeOutCirc:t=>l(1-a(t-1,2)),easeInOutCirc:t=>t<.5?(1-l(1-a(2*t,2)))/2:(l(1-a(-2*t+2,2))+1)/2,easeInBack:t=>i*t*t*t-s*t*t,easeOutBack:t=>1+i*a(t-1,3)+s*a(t-1,2),easeInOutBack:t=>t<.5?a(2*t,2)*(2*(1+e)*t-e)/2:(a(2*t-2,2)*((1+e)*(2*t-2)+e)+2)/2,easeInElastic:t=>0===t?0:1===t?1:-a(2,10*t-10)*o((10*t-10.75)*r),easeOutElastic:t=>0===t?0:1===t?1:a(2,-10*t)*o((10*t-.75)*r)+1,easeInOutElastic:t=>0===t?0:1===t?1:t<.5?-(a(2,20*t-10)*o((20*t-11.125)*n))/2:a(2,-20*t+10)*o((20*t-11.125)*n)/2+1,easeInBounce:t=>1-h(1-t),easeOutBounce:h,easeInOutBounce:t=>t<.5?(1-h(1-2*t))/2:(1+h(2*t-1))/2}}(),e=()=>performance.now();const r=[];let n=null,t=null;function B(s){var e=(s-t)/16.66;for(let t=0;t<r.length;t++)r[t].needsUpdate(s)?r[t].update(s,e):(r.splice(t,1)[0].complete(s,e),t--);n=r.length?(t=s,requestAnimationFrame(B)):null}var h={add(t){return-1===r.indexOf(t)&&(r.push(t),null===n&&this.start()),this},remove(t){t=r.indexOf(t);return-1<t&&r.splice(t,1),this},start(){return null===n&&(t=e(),n=requestAnimationFrame(B)),this},stop(){return cancelAnimationFrame(n),n=null,this},destroy(){r.length=0,this.stop()}};function p(){const s=arguments,e=s[0];for(let t=1;t<s.length;t++)for(var i in s[t])void 0!==s[t][i]&&(e[i]=s[t][i]);return e}var _=()=>{};class f{constructor(t){p(this,f.defaults,t)}start(){return h.add(this),this.onStart.call(this,e(),0),this}stop(){return h.remove(this),this.onStop.call(this,e(),0),this}update(t,s){return this.onUpdate.call(this,t,s),this}complete(t,s){return this.onComplete.call(this,t,s),this}needsUpdate(){return!0}static defaults={onStart:_,onUpdate:_,onStop:_,onComplete:_}}class D extends f{constructor(t){super(p({},D.defaults,t)),this._a=0,this._b=1,this._c=0,this._d=this.reverse?1:0,this._e=0,this._f=null,this.autoStart&&this.start()}reset(){return this._f=null,this._b=1,this._c=0,this._d=this.reverse?1:0,h.remove(this),this.onUpdate(0,0,0),this}pause(){return this._f=e(),h.remove(this),this}start(t){return 0===(t=0===t||t?t:this.delay)?(this._f?(this._e+=e()-this._f,this._f=null):(this.reverse&&(this._b=F[this._d](this._c),this._d=(this._d+1)%2),this._e=0,this._a=e(),this.onStart(this._a,0,1-this._b)),h.add(this)):setTimeout(this.start.bind(this,0),t),this}update(t,s){var e=z[this.easing]((t-(this._a+this._e))/(this.duration*this._b))*this._b+1-this._b,e=F[this._d](e);return this._c=e,this.onUpdate(t,s,e),this}complete(t,s){var e=(this._d+1)%2;return this._f=null,this.onUpdate(t,s,e),this.onComplete(t,s,e),0<this.loop&&(this.loop--,this.start()),this}needsUpdate(t){return t-(this._a+this._e)<this.duration*this._b}static defaults={delay:0,duration:1e3,easing:"linear",loop:0,reverse:!1,autoStart:!0}}const F=[t=>t,t=>1-t];var y=(t,s)=>"string"==typeof t?(s||document).querySelectorAll(t):0<=t.length?t:[t];const v=[];class b extends f{constructor(t,s,e){super();const i={};i[s+"start"]=[],i[s]=[],i[s+"end"]=[],this._g=i,this._h=!1,this._i=null,this._j=t,this._k=s,this._l=null,this._m=e||"",this._n=()=>{this._h=!1},this._o=t=>{this._l=t,this._h||(this._h=!0,this.start(),x(this._g[this._k+"start"],t)),clearTimeout(this._i),this._i=setTimeout(this._n,128)},this._j.addEventListener(this._k,this._o,{passive:!0})}destroy(){var t=v.indexOf(this);-1<t&&v.splice(t,1),this._j.removeEventListener(this._k,this._o)}add(t,s){return-1===this._g[t].indexOf(s)&&this._g[t].push(s),this}remove(t,s){s=this._g[t].indexOf(s);return-1<s&&this._g[t].splice(s,1),this}hasEvent(){var t=this._g,s=this._k;return 0<t[s+"start"].length+t[s].length+t[s+"end"].length}update(t,s){return x(this._g[this._k],this._l),super.update(t,s),this}complete(t,s){return x(this._g[this._k+"end"],this._l),super.complete(t,s),this}needsUpdate(){return this._h}static getInstance(s,e,i){let r;i=i||"";for(let t=0;t<v.length;t++){var n=v[t];if(n._k===e&&n._j===s&&n._m===i){r=v[t];break}}return r||(r=new b(s,e,i),v.push(r)),r}static destroy(){for(;v[0];)v[0].destroy()}}function x(s,e){for(let t=0;t<s.length;t++)s[t](e)}class g{constructor(t,s){this.x=t||0,this.y="number"==typeof s?s:this.x}set(t,s){return this.x=t,this.y=s,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}subtractScalar(t){return this.x-=t,this.y-=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.x/=t,this.y/=t,this}magnitude(){return l(this.x*this.x+this.y*this.y)}normalize(){return this.divideScalar(this.magnitude())}reverse(){return this.multiplyScalar(-1)}copy(t){return this.x=t.x,this.y=t.y,this}clone(){return new g(this.x,this.y)}angle(){var t=s.atan2(this.y,this.x);return t<0&&(t+=2*c),t}rotate(t){var s=this.x;return this.x=s*d(t)-this.y*o(t),this.y=s*o(t)+this.y*d(t),this}}var m=()=>new g(U.scrollWidth,U.scrollHeight),T=()=>new g(u.pageXOffset,u.pageYOffset);class j{constructor(t,s,e){p(this,j.defaults,s),this.element=t,this._p=!1,this.children=this.children?y(this.children,this.element):[],this.refresh(e)}refresh(t){var s=this.element.getBoundingClientRect(),e=u.innerHeight,i=u.innerWidth,r=T(),n=r.x,r=r.y,h=m();return this.distanceRTW=new g(i+s.right-s.left,e+s.bottom-s.top),this.startRTW=new g(s.right-this.distanceRTW.x+n,s.bottom-this.distanceRTW.y+r),this.startRTE=new g(q(s.left+n-i,0),q(s.top+r-e,0)),this.distanceRTE=new g(Q(s.right+n-this.startRTE.x,h.x-i),Q(s.bottom+r-this.startRTE.y,h.y-e)),this.control(t),this}control(t){const s=t.scroll,e=s.clone().subtract(this.startRTW).divide(this.distanceRTW),i=s.clone().subtract(this.startRTE).divide(this.distanceRTE);return 0<=e.x&&e.x<=1&&0<=e.y&&e.y<=1?(this._p||(this._p=!0,this.onVisibilityStart.call(this,t,O(e),O(i)),this.onVisible.call(this,t,O(e),O(i))),this.onVisible.call(this,t,e,i)):this._p&&(this._p=!1,this.onVisible.call(this,t,O(e),O(i)),this.onVisibilityEnd.call(this,t,O(e),O(i))),this.onAlways.call(this,t,e,i),this}static defaults={children:"",onVisible:_,onVisibilityStart:_,onVisibilityEnd:_,onAlways:_}}function O(t){return new g(i(V(t.x)),i(V(t.y)))}const w=[];let I=null,S=null,R=null;class E extends f{constructor(t){super(p({},E.defaults,t)),this._q=[],this._r=[],this._s=()=>this.start(),this._t=()=>this.refresh(),this._u=new g(0,0),this._h=!0,this._v=m(),S=S||new b(u,"resize"),R=R||new b(u,"scroll"),S.add("resize",this._t),R.add("scrollstart",this._s),w.push(this),E.startAutoRefresh()}destroy(){this._h&&(this._h=!1,w.splice(w.indexOf(this),1),0===w.length?(E.stopAutoRefresh(),S.destroy(),R.destroy(),S=R=null):(S.remove("resize",this._t),R.remove("scrollstart",this._s)))}observe(t,s){var e=y(t),i=this.getScrollInfos();for(let t=0;t<e.length;t++)-1===this._q.indexOf(e[t])&&(this._r.push(new j(e[t],s,i)),this._q.push(e[t]));return this}unobserve(t){var s=y(t);for(let t=0;t<s.length;t++){var e=this._q.indexOf(s[t]);-1<e&&(this._q.splice(e,1),this._r.splice(e,1))}return this}update(t,s){super.update(t,s);var e=this.getScrollInfos();for(let t=0;t<this._r.length;t++)this._r[t].control(e);return this._u.copy(e.scroll),this}needsUpdate(){return this._h&&R.needsUpdate()||1<this.scrollDivider&&1<T().subtract(this._u).magnitude()}hasEntry(){return 0<this._r.length}getScrollInfos(){const t=this._u,s=T().subtract(t).divideScalar(this.scrollDivider).add(t),e=s.clone().subtract(t);return{scroll:s,delta:e,direction:new g(e.x/i(e.x)||0,e.y/i(e.y)||0)}}refresh(){var s=this.getScrollInfos();for(let t=0;t<this._r.length;t++)this._r[t].refresh(s);return this.onRefresh.call(this,s),this}static defaults={scrollDivider:1,onRefresh:_};static autoRefreshDelay=1e3;static startAutoRefresh(){let s=m();return null===I&&null!==E.autoRefreshDelay&&(I=setInterval(()=>{var t=m();if(s.x!==t.x||s.y!==t.y){for(let t=0;t<w.length;t++)w[t].refresh();s=t}},E.autoRefreshDelay)),this}static stopAutoRefresh(){return clearInterval(I),I=null,this}static destroy(){for(;w[0];)w[0].destroy()}}const L=[],N=/(((?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])((\u200D(\u2640|\u2642)\uFE0F)|[]))|&([a-zA-Z]{2,6}|#[0-9]{2,5});|<|>)/g,P=/(\s)/;let W=null;class H{constructor(t,s){p(this,H.defaults,s),this._w=t.innerHTML,this._x=t,this._t=this.split.bind(this),W=W||new b(u,"resize"),this.autoSplit&&this.split(),L.push(this)}destroy(){var t=L.indexOf(this);-1<t&&(this.restore(),L.splice(t,1),L.length||(W.destroy(),W=null))}restore(){return this._x.innerHTML=this._w,W.remove("resize",this._t),this}split(){const t=this._x;if(t.innerHTML=this._w,this.byLine){X(t,M("st-word-temp"));var r=t.children,n=(t,s)=>t?this.lineWrapper(t)+s:"";let s="",e="",i=r[0].offsetTop;W.add("resize",this._t);for(let t=0;t<r.length;t++){var h=r[t],u=h.offsetTop,a="BR"===h.tagName;i===u&&!a||(e+=n(s.substring(-1)," "),s=""),a?e+="<br />":s+=h.outerHTML+" ",i=u}t.innerHTML=e+n(s,""),t.innerHTML=function s(t,e){return k(t,t=>t,t=>t.classList.contains(e)?t.innerHTML:A(t,s(t,e)))}(t,"st-word-temp")}return this.byWord&&X(t,this.wordWrapper),this.byChar&&(t.innerHTML=function s(t,e){return k(t,t=>t.replace(N,e),t=>A(t,s(t,e)))}(t,this.charWrapper),t.innerHTML=C(t,"",t=>P.test(t)?t:this.charWrapper(t),this.preserve)),this}static defaults={autoSplit:!0,byLine:!1,byWord:!1,byChar:!1,preserve:"st-char",lineWrapper:M("st-line"),wordWrapper:M("st-word"),charWrapper:M("st-char")}}function M(s){return t=>'<span class="'+s+'">'+t+"</span>"}function k(t,s,e){var i=t.childNodes;let r="";for(let t=0;t<i.length;t++){var n=i[t];3===n.nodeType?r+=s(n.data):1===n.nodeType&&(r+=e(n))}return r}function C(t,e,i,s){return k(t,t=>{const s=t.trim();return""!==s?(""===e?t:s).split(e).map(i).join(e):t},t=>s&&t.classList.contains(s)?t.outerHTML:A(t,C(t,e,i,s)))}function A(t,s){return t.outerHTML.replace(">"+t.innerHTML+"<",">"+s+"<")}function X(t,s){t.innerHTML=function s(t){return k(t,t=>t.replace("<","[<]"),t=>A(t,s(t)))}(t),t.innerHTML=C(t," ",s).replace("[<]","&lt;")}H.destroy=function(){for(;L[0];)L[0].destroy()};export{f as MainLoopEntry,E as ScrollObserver,H as SplittedText,b as ThrottledEvent,D as Tween,g as Vector2,z as easings};
